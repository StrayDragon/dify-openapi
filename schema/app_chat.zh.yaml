openapi: 3.0.0
info:
  title: Dify API - å¯¹è¯å‹åº”ç”¨
  description: |
    Dify API æä¾›äº†ä¸€ç³»åˆ—æ¥å£ç”¨äºå¯¹è¯åŠŸèƒ½ã€‚
    æ”¯æŒå¯¹è¯å‹åº”ç”¨ã€‚
    æ‰€æœ‰ API è¯·æ±‚éƒ½éœ€è¦åœ¨ Authorization HTTP Header ä¸­åŒ…å«åº”ç”¨çº§ API-Keyã€‚
    å®˜æ–¹åŸå§‹æ–‡æ¡£è§: https://github.com/langgenius/dify/blob/1.5.1/web/app/components/develop/template/template_chat.zh.mdx
  version: 1.5.1

servers:
  - url: https://api.dify.ai/v1
    description: Dify API æœåŠ¡å™¨

  - url: "{api_url}"
    variables:
      api_url:
        default: https://api.dify.ai/v1
        description: è‡ªå®šä¹‰ API æœåŠ¡å™¨ URL

  - url: http://ai.urchinet.lan/v1
    description: author of dify-openapi dev server

security:
  - bearerApiKeyAuth: []

components:
  securitySchemes:
    bearerApiKeyAuth:
      type: http
      scheme: bearer

  responses:
    Error400:
      description: è¯·æ±‚é”™è¯¯
      content:
        application/json:
          schema:
            $ref: "#/components/schemas/Error"

    Error401:
      description: æœªæˆæƒæˆ–æˆæƒå¤±è´¥
      content:
        application/json:
          schema:
            $ref: "#/components/schemas/Error"

    Error404:
      description: èµ„æºä¸å­˜åœ¨
      content:
        application/json:
          schema:
            $ref: "#/components/schemas/Error"

    Error500:
      description: æœåŠ¡å™¨é”™è¯¯
      content:
        application/json:
          schema:
            $ref: "#/components/schemas/Error"

  schemas:
    Error:
      type: object
      properties:
        code:
          type: string
          description: é”™è¯¯ä»£ç 
        status:
          type: integer
          description: HTTP çŠ¶æ€ç 
        message:
          type: string
          description: é”™è¯¯ä¿¡æ¯æè¿°
      required:
        - code
        - status
        - message

    Usage:
      type: object
      properties:
        prompt_tokens:
          type: integer
          description: æç¤ºè¯ä½¿ç”¨çš„ token æ•°é‡
        completion_tokens:
          type: integer
          description: è¡¥å…¨ä½¿ç”¨çš„ token æ•°é‡
        total_tokens:
          type: integer
          description: æ€»å…±ä½¿ç”¨çš„ token æ•°é‡
        prompt_unit_price:
          type: string
          description: æç¤ºè¯å•ä»·
        prompt_price_unit:
          type: string
          description: æç¤ºè¯ä»·æ ¼å•ä½
        prompt_price:
          type: string
          description: æç¤ºè¯æ€»ä»·
        completion_unit_price:
          type: string
          description: è¡¥å…¨å•ä»·
        completion_price_unit:
          type: string
          description: è¡¥å…¨ä»·æ ¼å•ä½
        completion_price:
          type: string
          description: è¡¥å…¨æ€»ä»·
        total_price:
          type: string
          description: æ€»ä»·æ ¼
        currency:
          type: string
          description: è´§å¸å•ä½
        latency:
          type: number
          description: å»¶è¿Ÿæ—¶é—´

    RetrieverResource:
      type: object
      properties:
        position:
          type: integer
          description: ä½ç½®
        dataset_id:
          type: string
          description: æ•°æ®é›†ID
        dataset_name:
          type: string
          description: æ•°æ®é›†åç§°
        document_id:
          type: string
          description: æ–‡æ¡£ID
        document_name:
          type: string
          description: æ–‡æ¡£åç§°
        segment_id:
          type: string
          description: åˆ†æ®µID
        score:
          type: number
          description: ç›¸å…³åº¦åˆ†æ•°
        content:
          type: string
          description: å†…å®¹

    ChatCompletionResponse:
      type: object
      properties:
        message_id:
          type: string
          description: æ¶ˆæ¯å”¯ä¸€ ID
        created_at:
          type: integer
          description: æ¶ˆæ¯åˆ›å»ºæ—¶é—´æˆ³
        metadata:
          type: object
          properties:
            usage:
              $ref: "#/components/schemas/Usage"
            retriever_resources:
              type: array
              items:
                $ref: "#/components/schemas/RetrieverResource"
        conversation_id:
          type: string
          description: ä¼šè¯ID
        mode:
          type: string
          description: App æ¨¡å¼ï¼Œå›ºå®šä¸º chat
        answer:
          type: string
          description: å®Œæ•´å›å¤å†…å®¹

    Conversation:
      type: object
      properties:
        id:
          type: string
          description: ä¼šè¯ ID
        name:
          type: string
          description: ä¼šè¯åç§°
        inputs:
          type: object
          description: ç”¨æˆ·è¾“å…¥å‚æ•°
        status:
          type: string
          description: ä¼šè¯çŠ¶æ€
        introduction:
          type: string
          description: å¼€åœºç™½
        created_at:
          type: integer
          description: åˆ›å»ºæ—¶é—´
        updated_at:
          type: integer
          description: æ›´æ–°æ—¶é—´

    FileInput:
      type: object
      properties:
        type:
          type: string
          enum: [document, image, audio, video, custom]
          description: æ–‡ä»¶ç±»å‹
        transfer_method:
          type: string
          enum: [remote_url, local_file]
          description: ä¼ é€’æ–¹å¼
        url:
          type: string
          description: è¿œç¨‹URL
        upload_file_id:
          type: string
          description: ä¸Šä¼ æ–‡ä»¶ID

    ChatHistoryMessage:
      type: object
      properties:
        id:
          type: string
          description: æ¶ˆæ¯ ID
        conversation_id:
          type: string
          description: ä¼šè¯ ID
        inputs:
          type: object
          description: ç”¨æˆ·è¾“å…¥å‚æ•°
        query:
          type: string
          description: ç”¨æˆ·è¾“å…¥/æé—®å†…å®¹
        message_files:
          type: array
          items:
            type: object
            properties:
              id:
                type: string
                description: ID
              type:
                type: string
                description: æ–‡ä»¶ç±»å‹ï¼Œimage å›¾ç‰‡
              url:
                type: string
                description: é¢„è§ˆå›¾ç‰‡åœ°å€
              belongs_to:
                type: string
                description: æ–‡ä»¶å½’å±æ–¹ï¼Œuser æˆ– assistant
          description: æ¶ˆæ¯æ–‡ä»¶
        agent_thoughts:
          type: array
          items:
            type: object
            properties:
              id:
                type: string
                description: agent_thought IDï¼Œæ¯ä¸€è½®Agentè¿­ä»£éƒ½ä¼šæœ‰ä¸€ä¸ªå”¯ä¸€çš„id
              message_id:
                type: string
                description: æ¶ˆæ¯å”¯ä¸€ID
              position:
                type: integer
                description: agent_thoughtåœ¨æ¶ˆæ¯ä¸­çš„ä½ç½®ï¼Œå¦‚ç¬¬ä¸€è½®è¿­ä»£positionä¸º1
              thought:
                type: string
                description: agentçš„æ€è€ƒå†…å®¹
              observation:
                type: string
                description: å·¥å…·è°ƒç”¨çš„è¿”å›ç»“æœ
              tool:
                type: string
                description: ä½¿ç”¨çš„å·¥å…·åˆ—è¡¨ï¼Œä»¥ ; åˆ†å‰²å¤šä¸ªå·¥å…·
              tool_input:
                type: string
                description: 'å·¥å…·çš„è¾“å…¥ï¼ŒJSONæ ¼å¼çš„å­—ç¬¦ä¸²(object)ã€‚å¦‚ï¼š{"dalle3": {"prompt": "a cute cat"}}'
              created_at:
                type: integer
                description: åˆ›å»ºæ—¶é—´æˆ³ï¼Œå¦‚ï¼š1705395332
              message_files:
                type: array
                items:
                  type: string
                description: å½“å‰agent_thoughtå…³è”çš„æ–‡ä»¶ID
              conversation_id:
                type: string
                description: ä¼šè¯ID
          description: Agentæ€è€ƒå†…å®¹ï¼ˆä»…Agentæ¨¡å¼ä¸‹ä¸ä¸ºç©ºï¼‰
        answer:
          type: string
          description: å›ç­”æ¶ˆæ¯å†…å®¹
        created_at:
          type: integer
          description: åˆ›å»ºæ—¶é—´
        feedback:
          type: object
          properties:
            rating:
              type: string
              enum: [like, dislike]
              description: ç‚¹èµ like / ç‚¹è¸© dislike
          description: åé¦ˆä¿¡æ¯
        retriever_resources:
          type: array
          items:
            $ref: "#/components/schemas/RetrieverResource"
          description: å¼•ç”¨å’Œå½’å±åˆ†æ®µåˆ—è¡¨

    ChunkChatCompletionResponse:
      type: object
      properties:
        event:
          type: string
          enum:
            [
              message,
              message_end,
              tts_message,
              tts_message_end,
              message_replace,
              error,
              ping,
              agent_message,
              agent_thought,
              message_file,
            ]
          description: äº‹ä»¶ç±»å‹
        task_id:
          type: string
          description: ä»»åŠ¡ IDï¼Œç”¨äºè¯·æ±‚è·Ÿè¸ªå’Œåœæ­¢å“åº”æ¥å£
        message_id:
          type: string
          description: æ¶ˆæ¯å”¯ä¸€ ID
        conversation_id:
          type: string
          description: ä¼šè¯ ID
        workflow_run_id:
          type: string
          description: workflow æ‰§è¡Œ ID
        answer:
          type: string
          description: å›å¤å†…å®¹
        audio:
          type: string
          description: è¯­éŸ³åˆæˆéŸ³é¢‘æ•°æ®ï¼ˆbase64ç¼–ç ï¼‰
        data:
          type: object
          description: äº‹ä»¶ç›¸å…³æ•°æ®
        metadata:
          type: object
          description: å…ƒæ•°æ®ä¿¡æ¯ï¼ŒåŒ…å«ä½¿ç”¨é‡å’Œæ£€ç´¢èµ„æº
          properties:
            usage:
              $ref: "#/components/schemas/Usage"
            retriever_resources:
              type: array
              items:
                $ref: "#/components/schemas/RetrieverResource"
        created_at:
          type: integer
          description: åˆ›å»ºæ—¶é—´æˆ³
        id:
          type: string
          description: å”¯ä¸€ID
        position:
          type: integer
          description: agent_thoughtåœ¨æ¶ˆæ¯ä¸­çš„ä½ç½®ï¼Œå¦‚ç¬¬ä¸€è½®è¿­ä»£positionä¸º1
        thought:
          type: string
          description: agentçš„æ€è€ƒå†…å®¹
        observation:
          type: string
          description: å·¥å…·è°ƒç”¨çš„è¿”å›ç»“æœ
        tool:
          type: string
          description: ä½¿ç”¨çš„å·¥å…·åˆ—è¡¨ï¼Œä»¥ ; åˆ†å‰²å¤šä¸ªå·¥å…·
        tool_input:
          type: string
          description: å·¥å…·çš„è¾“å…¥ï¼ŒJSONæ ¼å¼çš„å­—ç¬¦ä¸²
        message_files:
          type: array
          items:
            type: string
          description: å½“å‰agent_thoughtå…³è”çš„æ–‡ä»¶ID
        type:
          type: string
          description: æ–‡ä»¶ç±»å‹
        belongs_to:
          type: string
          description: æ–‡ä»¶å½’å±ï¼Œuseræˆ–assistant
        url:
          type: string
          description: æ–‡ä»¶è®¿é—®åœ°å€

    UploadedFile:
      type: object
      properties:
        id:
          type: string
          description: æ–‡ä»¶ ID
        name:
          type: string
          description: æ–‡ä»¶å
        size:
          type: integer
          description: æ–‡ä»¶å¤§å°ï¼ˆbyteï¼‰
        extension:
          type: string
          description: æ–‡ä»¶åç¼€
        mime_type:
          type: string
          description: æ–‡ä»¶ mime-type
        created_by:
          type: string
          description: ä¸Šä¼ äºº ID
        created_at:
          type: integer
          description: ä¸Šä¼ æ—¶é—´

paths:
  /chat-messages:
    post:
      operationId: sendChatMessageByAppChat
      summary: å‘é€å¯¹è¯æ¶ˆæ¯(å¯¹è¯å‹åº”ç”¨)
      description: åˆ›å»ºä¼šè¯æ¶ˆæ¯
      x-fern-streaming:
        format: sse
        # FIXME: @l8ng fern æš‚æ—¶ä¸æ”¯æŒ
        # stream-condition: $request.response_mode == "streaming"
        response:
          $ref: "#/components/schemas/ChatCompletionResponse"
        response-stream:
          $ref: "#/components/schemas/ChunkChatCompletionResponse"
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - query
              properties:
                query:
                  type: string
                  description: ç”¨æˆ·è¾“å…¥/æé—®å†…å®¹
                inputs:
                  type: object
                  description: å…è®¸ä¼ å…¥ App å®šä¹‰çš„å„å˜é‡å€¼ã€‚inputs å‚æ•°åŒ…å«äº†å¤šç»„é”®å€¼å¯¹ï¼ˆKey/Value pairsï¼‰ï¼Œæ¯ç»„çš„é”®å¯¹åº”ä¸€ä¸ªç‰¹å®šå˜é‡ï¼Œæ¯ç»„çš„å€¼åˆ™æ˜¯è¯¥å˜é‡çš„å…·ä½“å€¼ã€‚é»˜è®¤ {}
                response_mode:
                  type: string
                  enum: [streaming, blocking]
                  description: |
                    å“åº”æ¨¡å¼:
                    - streaming: æµå¼æ¨¡å¼ï¼ˆæ¨èï¼‰ï¼ŒåŸºäº SSE å®ç°ç±»ä¼¼æ‰“å­—æœºè¾“å‡º
                    - blocking: é˜»å¡æ¨¡å¼ï¼Œç­‰å¾…æ‰§è¡Œå®Œæ¯•åè¿”å›ç»“æœï¼ˆè¯·æ±‚è‹¥æµç¨‹è¾ƒé•¿å¯èƒ½ä¼šè¢«ä¸­æ–­ï¼‰
                    æ³¨ï¼šAgentæ¨¡å¼ä¸‹ä¸å…è®¸blocking
                user:
                  type: string
                  description: ç”¨æˆ·æ ‡è¯†ï¼Œç”¨äºå®šä¹‰ç»ˆç«¯ç”¨æˆ·çš„èº«ä»½ï¼Œæ–¹ä¾¿æ£€ç´¢ã€ç»Ÿè®¡ã€‚ç”±å¼€å‘è€…å®šä¹‰è§„åˆ™ï¼Œéœ€ä¿è¯ç”¨æˆ·æ ‡è¯†åœ¨åº”ç”¨å†…å”¯ä¸€ã€‚æœåŠ¡ API ä¸ä¼šå…±äº« WebApp åˆ›å»ºçš„å¯¹è¯ã€‚
                conversation_id:
                  type: string
                  description: ï¼ˆé€‰å¡«ï¼‰ä¼šè¯ IDï¼Œéœ€è¦åŸºäºä¹‹å‰çš„èŠå¤©è®°å½•ç»§ç»­å¯¹è¯ï¼Œå¿…é¡»ä¼ ä¹‹å‰æ¶ˆæ¯çš„ conversation_id
                files:
                  type: array
                  items:
                    type: object
                    properties:
                      type:
                        type: string
                        enum: [image]
                        description: æ”¯æŒç±»å‹ï¼šå›¾ç‰‡ imageï¼ˆç›®å‰ä»…æ”¯æŒå›¾ç‰‡æ ¼å¼ï¼‰
                      transfer_method:
                        type: string
                        enum: [remote_url, local_file]
                        description: ä¼ é€’æ–¹å¼
                      url:
                        type: string
                        description: å›¾ç‰‡åœ°å€ï¼ˆä»…å½“ä¼ é€’æ–¹å¼ä¸º remote_url æ—¶ï¼‰
                      upload_file_id:
                        type: string
                        description: ä¸Šä¼ æ–‡ä»¶ IDï¼ˆä»…å½“ä¼ é€’æ–¹å¼ä¸º local_file æ—¶ï¼‰
                  description: ä¸Šä¼ çš„æ–‡ä»¶
                auto_generate_name:
                  type: boolean
                  description: ï¼ˆé€‰å¡«ï¼‰è‡ªåŠ¨ç”Ÿæˆæ ‡é¢˜ï¼Œé»˜è®¤ trueã€‚è‹¥è®¾ç½®ä¸º falseï¼Œåˆ™å¯é€šè¿‡è°ƒç”¨ä¼šè¯é‡å‘½åæ¥å£å¹¶è®¾ç½® auto_generate ä¸º true å®ç°å¼‚æ­¥ç”Ÿæˆæ ‡é¢˜ã€‚
                  default: true
      responses:
        "200":
          description: æˆåŠŸå“åº”
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ChatCompletionResponse"
                description: å½“ response_mode ä¸º blocking æ—¶ï¼Œè¿”å› ChatCompletionResponse object
            text/event-stream:
              schema:
                $ref: "#/components/schemas/ChunkChatCompletionResponse"
                format: sse
                description: |
                  å½“ response_mode ä¸º streamingæ—¶ï¼Œè¿”å› ChunkChatCompletionResponse object æµå¼åºåˆ—ã€‚
                  è¿”å› App è¾“å‡ºçš„æµå¼å—ï¼ŒContent-Type ä¸º text/event-streamã€‚
                  æ¯ä¸ªæµå¼å—å‡ä¸º data: å¼€å¤´ï¼Œå—ä¹‹é—´ä»¥ \n\n å³ä¸¤ä¸ªæ¢è¡Œç¬¦åˆ†éš”ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š

                  data: {"event": "message", "task_id": "900bbd43-dc0b-4383-a372-aa6e6c414227", "id": "663c5084-a254-4040-8ad3-51f2a3c1a77c", "answer": "Hi", "created_at": 1705398420}\n\n

                  æµå¼å—ä¸­æ ¹æ® event ä¸åŒï¼Œç»“æ„ä¹Ÿä¸åŒï¼š

                  - event: message LLM è¿”å›æ–‡æœ¬å—äº‹ä»¶ï¼Œå³ï¼šå®Œæ•´çš„æ–‡æœ¬ä»¥åˆ†å—çš„æ–¹å¼è¾“å‡ºã€‚
                    - task_id (string) ä»»åŠ¡ IDï¼Œç”¨äºè¯·æ±‚è·Ÿè¸ªå’Œä¸‹æ–¹çš„åœæ­¢å“åº”æ¥å£
                    - message_id (string) æ¶ˆæ¯å”¯ä¸€ ID
                    - conversation_id (string) ä¼šè¯ ID
                    - answer (string) LLM è¿”å›æ–‡æœ¬å—å†…å®¹
                    - created_at (int) åˆ›å»ºæ—¶é—´æˆ³ï¼Œå¦‚ï¼š1705395332
                  - event: message_file æ–‡ä»¶äº‹ä»¶ï¼Œè¡¨ç¤ºæœ‰æ–°æ–‡ä»¶éœ€è¦å±•ç¤º
                    - id (string) æ–‡ä»¶å”¯ä¸€ID
                    - type (string) æ–‡ä»¶ç±»å‹ï¼Œç›®å‰ä»…ä¸ºimage
                    - belongs_to (string) æ–‡ä»¶å½’å±ï¼Œuseræˆ–assistantï¼Œè¯¥æ¥å£è¿”å›ä»…ä¸º assistant
                    - url (string) æ–‡ä»¶è®¿é—®åœ°å€
                    - conversation_id (string) ä¼šè¯ID
                  - event: message_end æ¶ˆæ¯ç»“æŸäº‹ä»¶ï¼Œæ”¶åˆ°æ­¤äº‹ä»¶åˆ™ä»£è¡¨æµå¼è¿”å›ç»“æŸã€‚
                    - task_id (string) ä»»åŠ¡ IDï¼Œç”¨äºè¯·æ±‚è·Ÿè¸ªå’Œä¸‹æ–¹çš„åœæ­¢å“åº”æ¥å£
                    - message_id (string) æ¶ˆæ¯å”¯ä¸€ ID
                    - conversation_id (string) ä¼šè¯ ID
                    - metadata (object) å…ƒæ•°æ®
                      - usage (Usage) æ¨¡å‹ç”¨é‡ä¿¡æ¯
                      - retriever_resources (array[RetrieverResource]) å¼•ç”¨å’Œå½’å±åˆ†æ®µåˆ—è¡¨
                  - event: tts_message TTS éŸ³é¢‘æµäº‹ä»¶ï¼Œå³ï¼šè¯­éŸ³åˆæˆè¾“å‡ºã€‚å†…å®¹æ˜¯Mp3æ ¼å¼çš„éŸ³é¢‘å—ï¼Œä½¿ç”¨ base64 ç¼–ç åçš„å­—ç¬¦ä¸²ï¼Œæ’­æ”¾çš„æ—¶å€™ç›´æ¥è§£ç å³å¯ã€‚(å¼€å¯è‡ªåŠ¨æ’­æ”¾æ‰æœ‰æ­¤æ¶ˆæ¯)
                    - task_id (string) ä»»åŠ¡ IDï¼Œç”¨äºè¯·æ±‚è·Ÿè¸ªå’Œä¸‹æ–¹çš„åœæ­¢å“åº”æ¥å£
                    - message_id (string) æ¶ˆæ¯å”¯ä¸€ ID
                    - audio (string) è¯­éŸ³åˆæˆä¹‹åçš„éŸ³é¢‘å—ä½¿ç”¨ Base64 ç¼–ç ä¹‹åçš„æ–‡æœ¬å†…å®¹ï¼Œæ’­æ”¾çš„æ—¶å€™ç›´æ¥ base64 è§£ç é€å…¥æ’­æ”¾å™¨å³å¯
                    - created_at (int) åˆ›å»ºæ—¶é—´æˆ³ï¼Œå¦‚ï¼š1705395332
                  - event: tts_message_end TTS éŸ³é¢‘æµç»“æŸäº‹ä»¶ï¼Œæ”¶åˆ°è¿™ä¸ªäº‹ä»¶è¡¨ç¤ºéŸ³é¢‘æµè¿”å›ç»“æŸã€‚
                    - task_id (string) ä»»åŠ¡ IDï¼Œç”¨äºè¯·æ±‚è·Ÿè¸ªå’Œä¸‹æ–¹çš„åœæ­¢å“åº”æ¥å£
                    - message_id (string) æ¶ˆæ¯å”¯ä¸€ ID
                    - audio (string) ç»“æŸäº‹ä»¶æ˜¯æ²¡æœ‰éŸ³é¢‘çš„ï¼Œæ‰€ä»¥è¿™é‡Œæ˜¯ç©ºå­—ç¬¦ä¸²
                    - created_at (int) åˆ›å»ºæ—¶é—´æˆ³ï¼Œå¦‚ï¼š1705395332
                  - event: message_replace æ¶ˆæ¯å†…å®¹æ›¿æ¢äº‹ä»¶ã€‚ å¼€å¯å†…å®¹å®¡æŸ¥å’Œå®¡æŸ¥è¾“å‡ºå†…å®¹æ—¶ï¼Œè‹¥å‘½ä¸­äº†å®¡æŸ¥æ¡ä»¶ï¼Œåˆ™ä¼šé€šè¿‡æ­¤äº‹ä»¶æ›¿æ¢æ¶ˆæ¯å†…å®¹ä¸ºé¢„è®¾å›å¤ã€‚
                    - task_id (string) ä»»åŠ¡ IDï¼Œç”¨äºè¯·æ±‚è·Ÿè¸ªå’Œä¸‹æ–¹çš„åœæ­¢å“åº”æ¥å£
                    - message_id (string) æ¶ˆæ¯å”¯ä¸€ ID
                    - conversation_id (string) ä¼šè¯ ID
                    - answer (string) æ›¿æ¢å†…å®¹ï¼ˆç›´æ¥æ›¿æ¢ LLM æ‰€æœ‰å›å¤æ–‡æœ¬ï¼‰
                    - created_at (int) åˆ›å»ºæ—¶é—´æˆ³ï¼Œå¦‚ï¼š1705395332
                  - event: workflow_started workflow å¼€å§‹æ‰§è¡Œ
                    - task_id (string) ä»»åŠ¡ IDï¼Œç”¨äºè¯·æ±‚è·Ÿè¸ªå’Œä¸‹æ–¹çš„åœæ­¢å“åº”æ¥å£
                    - workflow_run_id (string) workflow æ‰§è¡Œ ID
                    - event (string) å›ºå®šä¸º workflow_started
                    - data (object) è¯¦ç»†å†…å®¹
                      - id (string) workflow æ‰§è¡Œ ID
                      - workflow_id (string) å…³è” Workflow ID
                      - created_at (timestamp) å¼€å§‹æ—¶é—´
                  - event: node_started node å¼€å§‹æ‰§è¡Œ
                    - task_id (string) ä»»åŠ¡ IDï¼Œç”¨äºè¯·æ±‚è·Ÿè¸ªå’Œä¸‹æ–¹çš„åœæ­¢å“åº”æ¥å£
                    - workflow_run_id (string) workflow æ‰§è¡Œ ID
                    - event (string) å›ºå®šä¸º node_started
                    - data (object) è¯¦ç»†å†…å®¹
                      - id (string) workflow æ‰§è¡Œ ID
                      - node_id (string) èŠ‚ç‚¹ ID
                      - node_type (string) èŠ‚ç‚¹ç±»å‹
                      - title (string) èŠ‚ç‚¹åç§°
                      - index (int) æ‰§è¡Œåºå·ï¼Œç”¨äºå±•ç¤º Tracing Node é¡ºåº
                      - predecessor_node_id (string) å‰ç½®èŠ‚ç‚¹ IDï¼Œç”¨äºç”»å¸ƒå±•ç¤ºæ‰§è¡Œè·¯å¾„
                      - inputs (object) èŠ‚ç‚¹ä¸­æ‰€æœ‰ä½¿ç”¨åˆ°çš„å‰ç½®èŠ‚ç‚¹å˜é‡å†…å®¹
                      - created_at (timestamp) å¼€å§‹æ—¶é—´
                  - event: node_finished node æ‰§è¡Œç»“æŸï¼ŒæˆåŠŸå¤±è´¥åŒä¸€äº‹ä»¶ä¸­ä¸åŒçŠ¶æ€
                    - task_id (string) ä»»åŠ¡ IDï¼Œç”¨äºè¯·æ±‚è·Ÿè¸ªå’Œä¸‹æ–¹çš„åœæ­¢å“åº”æ¥å£
                    - workflow_run_id (string) workflow æ‰§è¡Œ ID
                    - event (string) å›ºå®šä¸º node_finished
                    - data (object) è¯¦ç»†å†…å®¹
                      - id (string) node æ‰§è¡Œ ID
                      - node_id (string) èŠ‚ç‚¹ ID
                      - index (int) æ‰§è¡Œåºå·ï¼Œç”¨äºå±•ç¤º Tracing Node é¡ºåº
                      - predecessor_node_id (string) optional å‰ç½®èŠ‚ç‚¹ IDï¼Œç”¨äºç”»å¸ƒå±•ç¤ºæ‰§è¡Œè·¯å¾„
                      - inputs (object) èŠ‚ç‚¹ä¸­æ‰€æœ‰ä½¿ç”¨åˆ°çš„å‰ç½®èŠ‚ç‚¹å˜é‡å†…å®¹
                      - process_data (json) Optional èŠ‚ç‚¹è¿‡ç¨‹æ•°æ®
                      - outputs (json) Optional è¾“å‡ºå†…å®¹
                      - status (string) æ‰§è¡ŒçŠ¶æ€ running / succeeded / failed / stopped
                      - error (string) Optional é”™è¯¯åŸå› 
                      - elapsed_time (float) Optional è€—æ—¶(s)
                      - execution_metadata (json) å…ƒæ•°æ®
                        - total_tokens (int) optional æ€»ä½¿ç”¨ tokens
                        - total_price (decimal) optional æ€»è´¹ç”¨
                        - currency (string) optional è´§å¸ï¼Œå¦‚ USD / RMB
                      - created_at (timestamp) å¼€å§‹æ—¶é—´
                  - event: workflow_finished workflow æ‰§è¡Œç»“æŸï¼ŒæˆåŠŸå¤±è´¥åŒä¸€äº‹ä»¶ä¸­ä¸åŒçŠ¶æ€
                    - task_id (string) ä»»åŠ¡ IDï¼Œç”¨äºè¯·æ±‚è·Ÿè¸ªå’Œä¸‹æ–¹çš„åœæ­¢å“åº”æ¥å£
                    - workflow_run_id (string) workflow æ‰§è¡Œ ID
                    - event (string) å›ºå®šä¸º workflow_finished
                    - data (object) è¯¦ç»†å†…å®¹
                      - id (string) workflow æ‰§è¡Œ ID
                      - workflow_id (string) å…³è” Workflow ID
                      - status (string) æ‰§è¡ŒçŠ¶æ€ running / succeeded / failed / stopped
                      - outputs (json) Optional è¾“å‡ºå†…å®¹
                      - error (string) Optional é”™è¯¯åŸå› 
                      - elapsed_time (float) Optional è€—æ—¶(s)
                      - total_tokens (int) Optional æ€»ä½¿ç”¨ tokens
                      - total_steps (int) æ€»æ­¥æ•°ï¼ˆå†—ä½™ï¼‰ï¼Œé»˜è®¤ 0
                      - created_at (timestamp) å¼€å§‹æ—¶é—´
                      - finished_at (timestamp) ç»“æŸæ—¶é—´
                  - event: error æµå¼è¾“å‡ºè¿‡ç¨‹ä¸­å‡ºç°çš„å¼‚å¸¸ä¼šä»¥ stream event å½¢å¼è¾“å‡ºï¼Œæ”¶åˆ°å¼‚å¸¸äº‹ä»¶åå³ç»“æŸã€‚
                    - task_id (string) ä»»åŠ¡ IDï¼Œç”¨äºè¯·æ±‚è·Ÿè¸ªå’Œä¸‹æ–¹çš„åœæ­¢å“åº”æ¥å£
                    - message_id (string) æ¶ˆæ¯å”¯ä¸€ ID
                    - status (int) HTTP çŠ¶æ€ç 
                    - code (string) é”™è¯¯ç 
                    - message (string) é”™è¯¯æ¶ˆæ¯
                  - event: ping æ¯ 10s ä¸€æ¬¡çš„ ping äº‹ä»¶ï¼Œä¿æŒè¿æ¥å­˜æ´»ã€‚
        "400":
          $ref: "#/components/responses/Error400"
        "404":
          $ref: "#/components/responses/Error404"
        "500":
          $ref: "#/components/responses/Error500"

  /conversations:
    get:
      operationId: getConversationListByAppChat
      summary: è·å–ä¼šè¯åˆ—è¡¨
      description: è·å–å½“å‰ç”¨æˆ·çš„ä¼šè¯åˆ—è¡¨
      parameters:
        - name: user
          in: query
          required: true
          schema:
            type: string
        - name: last_id
          in: query
          schema:
            type: string
          description: å½“å‰é¡µæœ€åä¸€æ¡è®°å½•çš„ID
        - name: limit
          in: query
          schema:
            type: integer
            default: 20
          description: æ¯é¡µè®°å½•æ•°
        - name: sort_by
          in: query
          schema:
            type: string
            enum: [created_at, -created_at, updated_at, -updated_at]
            default: -updated_at
          description: æ’åºå­—æ®µ
      responses:
        "200":
          description: æˆåŠŸå“åº”
          content:
            application/json:
              schema:
                type: object
                properties:
                  data:
                    type: array
                    items:
                      $ref: "#/components/schemas/Conversation"
                  has_more:
                    type: boolean
                  limit:
                    type: integer

  /conversations/{conversation_id}:
    delete:
      operationId: deleteConversationByAppChat
      summary: åˆ é™¤ä¼šè¯
      parameters:
        - name: conversation_id
          in: path
          required: true
          schema:
            type: string
          description: ä¼šè¯ID
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - user
              properties:
                user:
                  type: string
                  description: ç”¨æˆ·æ ‡è¯†
      responses:
        "204":
          description: æˆåŠŸå“åº”ï¼Œæ— å†…å®¹

  /conversations/{conversation_id}/name:
    post:
      operationId: renameConversationByAppChat
      summary: ä¼šè¯é‡å‘½å
      parameters:
        - name: conversation_id
          in: path
          required: true
          schema:
            type: string
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - user
              properties:
                name:
                  type: string
                  description: æ–°åç§°
                auto_generate:
                  type: boolean
                  default: false
                  description: æ˜¯å¦è‡ªåŠ¨ç”Ÿæˆ
                user:
                  type: string
                  description: ç”¨æˆ·æ ‡è¯†
      responses:
        "200":
          description: æˆåŠŸå“åº”
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Conversation"

  /conversations/{conversation_id}/variables:
    get:
      operationId: getConversationVariablesByAppChat
      summary: è·å–å¯¹è¯å˜é‡
      description: ä»ç‰¹å®šå¯¹è¯ä¸­æ£€ç´¢å˜é‡ã€‚æ­¤ç«¯ç‚¹å¯¹äºæå–å¯¹è¯è¿‡ç¨‹ä¸­æ•è·çš„ç»“æ„åŒ–æ•°æ®éå¸¸æœ‰ç”¨ã€‚
      parameters:
        - name: conversation_id
          in: path
          description: è¦ä»ä¸­æ£€ç´¢å˜é‡çš„å¯¹è¯ID
          required: true
          schema:
            type: string
        - name: user
          in: query
          description: ç”¨æˆ·æ ‡è¯†ç¬¦ï¼Œç”±å¼€å‘äººå‘˜å®šä¹‰çš„è§„åˆ™ï¼Œåœ¨åº”ç”¨ç¨‹åºå†…å¿…é¡»å”¯ä¸€
          required: true
          schema:
            type: string
        - name: last_id
          in: query
          description: ï¼ˆé€‰å¡«ï¼‰å½“å‰é¡µæœ€åé¢ä¸€æ¡è®°å½•çš„ IDï¼Œé»˜è®¤ null
          schema:
            type: string
        - name: limit
          in: query
          description: ï¼ˆé€‰å¡«ï¼‰ä¸€æ¬¡è¯·æ±‚è¿”å›å¤šå°‘æ¡è®°å½•ï¼Œé»˜è®¤ 20 æ¡ï¼Œæœ€å¤§ 100 æ¡ï¼Œæœ€å° 1 æ¡
          schema:
            type: integer
            default: 20
            minimum: 1
            maximum: 100
      responses:
        "200":
          description: æˆåŠŸå“åº”
          content:
            application/json:
              schema:
                type: object
                properties:
                  limit:
                    type: integer
                    description: æ¯é¡µé¡¹ç›®æ•°
                  has_more:
                    type: boolean
                    description: æ˜¯å¦æœ‰æ›´å¤šé¡¹ç›®
                  data:
                    type: array
                    description: å˜é‡åˆ—è¡¨
                    items:
                      type: object
                      properties:
                        id:
                          type: string
                          description: å˜é‡ID
                        name:
                          type: string
                          description: å˜é‡åç§°
                        value_type:
                          type: string
                          description: å˜é‡ç±»å‹ï¼ˆå­—ç¬¦ä¸²ã€æ•°å­—ã€å¸ƒå°”ç­‰ï¼‰
                        value:
                          type: string
                          description: å˜é‡å€¼
                        description:
                          type: string
                          description: å˜é‡æè¿°
                        created_at:
                          type: integer
                          description: åˆ›å»ºæ—¶é—´æˆ³
                        updated_at:
                          type: integer
                          description: æœ€åæ›´æ–°æ—¶é—´æˆ³
        "404":
          description: å¯¹è¯ä¸å­˜åœ¨
          content:
            application/json:
              schema:
                type: object
                properties:
                  code:
                    type: string
                    enum: [conversation_not_exists]
                    description: é”™è¯¯ä»£ç 
                  message:
                    type: string
                    description: é”™è¯¯æ¶ˆæ¯

  /messages:
    get:
      operationId: getConversationMessagesByAppChat
      summary: è·å–ä¼šè¯å†å²æ¶ˆæ¯
      parameters:
        - name: conversation_id
          in: query
          required: true
          schema:
            type: string
        - name: user
          in: query
          required: true
          schema:
            type: string
        - name: first_id
          in: query
          schema:
            type: string
        - name: limit
          in: query
          schema:
            type: integer
            default: 20
      responses:
        "200":
          description: æˆåŠŸå“åº”
          content:
            application/json:
              schema:
                type: object
                properties:
                  data:
                    type: array
                    items:
                      $ref: "#/components/schemas/ChatHistoryMessage"
                  has_more:
                    type: boolean
                  limit:
                    type: integer

  /messages/{message_id}/feedbacks:
    post:
      operationId: sendMessageFeedbackByAppChat
      summary: æ¶ˆæ¯åé¦ˆï¼ˆç‚¹èµï¼‰
      description: æ¶ˆæ¯ç»ˆç«¯ç”¨æˆ·åé¦ˆã€ç‚¹èµï¼Œæ–¹ä¾¿åº”ç”¨å¼€å‘è€…ä¼˜åŒ–è¾“å‡ºé¢„æœŸ
      parameters:
        - name: message_id
          in: path
          required: true
          schema:
            type: string
          description: æ¶ˆæ¯ ID
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - user
              properties:
                rating:
                  type: string
                  enum: [like, dislike, null]
                  description: ç‚¹èµ like, ç‚¹è¸© dislike, æ’¤é”€ç‚¹èµ null
                user:
                  type: string
                  description: ç”¨æˆ·æ ‡è¯†ï¼Œç”±å¼€å‘è€…å®šä¹‰è§„åˆ™ï¼Œéœ€ä¿è¯ç”¨æˆ·æ ‡è¯†åœ¨åº”ç”¨å†…å”¯ä¸€ã€‚æœåŠ¡ API ä¸ä¼šå…±äº« WebApp åˆ›å»ºçš„å¯¹è¯ã€‚
                content:
                  type: string
                  description: æ¶ˆæ¯åé¦ˆçš„å…·ä½“ä¿¡æ¯
      responses:
        "200":
          description: æˆåŠŸå“åº”
          content:
            application/json:
              schema:
                type: object
                properties:
                  result:
                    type: string
                    enum: [success]
                    description: å›ºå®šè¿”å› success

  /app/feedbacks:
    get:
      operationId: getAppFeedbacksByAppChat
      summary: è·å–APPçš„æ¶ˆæ¯ç‚¹èµå’Œåé¦ˆ
      description: è·å–åº”ç”¨çš„ç»ˆç«¯ç”¨æˆ·åé¦ˆã€ç‚¹èµ
      parameters:
        - name: page
          in: query
          schema:
            type: integer
            default: 1
          description: åˆ†é¡µï¼Œé»˜è®¤å€¼ï¼š1
        - name: limit
          in: query
          schema:
            type: integer
            default: 20
          description: æ¯é¡µæ•°é‡ï¼Œé»˜è®¤å€¼ï¼š20
      responses:
        "200":
          description: æˆåŠŸå“åº”
          content:
            application/json:
              schema:
                type: object
                properties:
                  data:
                    type: array
                    items:
                      type: object
                      properties:
                        id:
                          type: string
                          description: åé¦ˆID
                        app_id:
                          type: string
                          description: åº”ç”¨ID
                        conversation_id:
                          type: string
                          description: ä¼šè¯ID
                        message_id:
                          type: string
                          description: æ¶ˆæ¯ID
                        rating:
                          type: string
                          description: è¯„åˆ†
                        content:
                          type: string
                          description: åé¦ˆå†…å®¹
                        from_source:
                          type: string
                          description: æ¥æº
                        from_end_user_id:
                          type: string
                          description: ç»ˆç«¯ç”¨æˆ·ID
                        from_account_id:
                          type: string
                          description: è´¦æˆ·ID
                        created_at:
                          type: string
                          description: åˆ›å»ºæ—¶é—´
                        updated_at:
                          type: string
                          description: æ›´æ–°æ—¶é—´
                    description: è¿”å›è¯¥APPçš„ç‚¹èµã€åé¦ˆåˆ—è¡¨

  /messages/{message_id}/suggested:
    get:
      operationId: getSuggestedQuestionsByAppChat
      summary: è·å–ä¸‹ä¸€è½®å»ºè®®é—®é¢˜åˆ—è¡¨
      description: è·å–ä¸‹ä¸€è½®å»ºè®®é—®é¢˜åˆ—è¡¨
      parameters:
        - name: message_id
          in: path
          required: true
          schema:
            type: string
          description: Message ID
        - name: user
          in: query
          required: true
          schema:
            type: string
          description: ç”¨æˆ·æ ‡è¯†ï¼Œç”±å¼€å‘è€…å®šä¹‰è§„åˆ™ï¼Œéœ€ä¿è¯ç”¨æˆ·æ ‡è¯†åœ¨åº”ç”¨å†…å”¯ä¸€ã€‚æœåŠ¡ API ä¸ä¼šå…±äº« WebApp åˆ›å»ºçš„å¯¹è¯ã€‚
      responses:
        "200":
          description: æˆåŠŸå“åº”
          content:
            application/json:
              schema:
                type: object
                properties:
                  result:
                    type: string
                    enum: [success]
                  data:
                    type: array
                    items:
                      type: string
                    description: å»ºè®®é—®é¢˜åˆ—è¡¨

  /files/upload:
    post:
      operationId: uploadFileByAppChat
      summary: ä¸Šä¼ æ–‡ä»¶
      description: |
        ä¸Šä¼ æ–‡ä»¶å¹¶åœ¨å‘é€æ¶ˆæ¯æ—¶ä½¿ç”¨ã€‚
        æ”¯æŒçš„æ–‡ä»¶ç±»å‹å–å†³äºåº”ç”¨ç±»å‹å’Œé…ç½®ã€‚
        ä¸Šä¼ çš„æ–‡ä»¶ä»…ä¾›å½“å‰ç»ˆç«¯ç”¨æˆ·ä½¿ç”¨ã€‚
      requestBody:
        required: true
        content:
          multipart/form-data:
            schema:
              type: object
              properties:
                file:
                  type: string
                  format: binary
                  description: è¦ä¸Šä¼ çš„æ–‡ä»¶
                user:
                  type: string
                  description: ç”¨æˆ·æ ‡è¯†
              required:
                - file
      responses:
        "200":
          description: æˆåŠŸå“åº”
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/UploadedFile"
        "400":
          $ref: "#/components/responses/Error400"
        "413":
          description: æ–‡ä»¶å¤ªå¤§
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "415":
          description: ä¸æ”¯æŒçš„æ–‡ä»¶ç±»å‹
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "503":
          description: å­˜å‚¨æœåŠ¡é”™è¯¯
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"

  /info:
    get:
      operationId: getApplicationInfoByAppChat
      summary: è·å–åº”ç”¨åŸºæœ¬ä¿¡æ¯
      responses:
        "200":
          description: æˆåŠŸå“åº”
          content:
            application/json:
              schema:
                type: object
                properties:
                  name:
                    type: string
                    description: åº”ç”¨åç§°
                  description:
                    type: string
                    description: åº”ç”¨æè¿°
                  tags:
                    type: array
                    items:
                      type: string
                    description: åº”ç”¨æ ‡ç­¾
                  mode:
                    type: string
                    description: åº”ç”¨æ¨¡å¼
                  author_name:
                    type: string
                    description: ä½œè€…åç§°

  /chat-messages/{task_id}/stop:
    post:
      operationId: stopChatResponseByAppChat
      summary: åœæ­¢å“åº”
      description: ä»…æ”¯æŒæµå¼æ¨¡å¼
      parameters:
        - name: task_id
          in: path
          required: true
          schema:
            type: string
          description: ä»»åŠ¡ IDï¼Œå¯åœ¨æµå¼è¿”å› Chunk ä¸­è·å–
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - user
              properties:
                user:
                  type: string
                  description: ç”¨æˆ·æ ‡è¯†ï¼Œç”¨äºå®šä¹‰ç»ˆç«¯ç”¨æˆ·çš„èº«ä»½ï¼Œå¿…é¡»å’Œå‘é€æ¶ˆæ¯æ¥å£ä¼ å…¥ user ä¿æŒä¸€è‡´ã€‚API æ— æ³•è®¿é—® WebApp åˆ›å»ºçš„ä¼šè¯ã€‚
      responses:
        "200":
          description: æˆåŠŸå“åº”
          content:
            application/json:
              schema:
                type: object
                properties:
                  result:
                    type: string
                    enum: [success]
                    description: å›ºå®šè¿”å› success

  /audio-to-text:
    post:
      operationId: convertAudioToTextByAppChat
      summary: è¯­éŸ³è½¬æ–‡å­—
      description: è¯­éŸ³è½¬æ–‡å­—
      requestBody:
        required: true
        content:
          multipart/form-data:
            schema:
              type: object
              properties:
                file:
                  type: string
                  format: binary
                  description: è¯­éŸ³æ–‡ä»¶
                user:
                  type: string
                  description: ç”¨æˆ·æ ‡è¯†
              required:
                - file
      responses:
        "200":
          description: æˆåŠŸå“åº”
          content:
            application/json:
              schema:
                type: object
                properties:
                  text:
                    type: string
                    description: è½¬æ¢åçš„æ–‡æœ¬

  /text-to-audio:
    post:
      operationId: convertTextToAudioByAppChat
      summary: æ–‡å­—è½¬è¯­éŸ³
      description: æ–‡å­—è½¬è¯­éŸ³
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                message_id:
                  type: string
                  description: Dify ç”Ÿæˆçš„æ–‡æœ¬æ¶ˆæ¯IDï¼Œåå°ä¼šé€šè¿‡ message_id æŸ¥æ‰¾ç›¸åº”çš„å†…å®¹ç›´æ¥åˆæˆè¯­éŸ³ä¿¡æ¯ã€‚å¦‚æœåŒæ—¶ä¼  message_id å’Œ textï¼Œä¼˜å…ˆä½¿ç”¨ message_id
                text:
                  type: string
                  description: è¯­éŸ³ç”Ÿæˆå†…å®¹ã€‚å¦‚æœæ²¡æœ‰ä¼  message_id çš„è¯ï¼Œåˆ™ä¼šä½¿ç”¨è¿™ä¸ªå­—æ®µçš„å†…å®¹
                user:
                  type: string
                  description: ç”¨æˆ·æ ‡è¯†ï¼Œç”±å¼€å‘è€…å®šä¹‰è§„åˆ™ï¼Œéœ€ä¿è¯ç”¨æˆ·æ ‡è¯†åœ¨åº”ç”¨å†…å”¯ä¸€ã€‚æœåŠ¡ API ä¸ä¼šå…±äº« WebApp åˆ›å»ºçš„å¯¹è¯ã€‚
      responses:
        "200":
          description: æˆåŠŸå“åº”
          content:
            audio/wav:
              schema:
                type: string
                format: binary
                description: éŸ³é¢‘æ–‡ä»¶

  /parameters:
    get:
      operationId: getApplicationParametersByAppChat
      summary: è·å–åº”ç”¨å‚æ•°
      responses:
        "200":
          description: æˆåŠŸå“åº”
          content:
            application/json:
              schema:
                type: object
                properties:
                  opening_statement:
                    type: string
                    description: å¼€åœºç™½
                  suggested_questions:
                    type: array
                    items:
                      type: string
                    description: å¼€åœºæ¨èé—®é¢˜åˆ—è¡¨
                  suggested_questions_after_answer:
                    type: object
                    properties:
                      enabled:
                        type: boolean
                    description: å›ç­”åæ¨èé—®é¢˜è®¾ç½®
                  speech_to_text:
                    type: object
                    properties:
                      enabled:
                        type: boolean
                    description: è¯­éŸ³è½¬æ–‡æœ¬è®¾ç½®
                  text_to_speech:
                    type: object
                    properties:
                      enabled:
                        type: boolean
                        description: æ˜¯å¦å¼€å¯
                      voice:
                        type: string
                        description: è¯­éŸ³ç±»å‹
                      language:
                        type: string
                        description: è¯­è¨€
                      autoPlay:
                        type: string
                        enum: [enabled, disabled]
                        description: è‡ªåŠ¨æ’­æ”¾
                    description: æ–‡æœ¬è½¬è¯­éŸ³è®¾ç½®
                  retriever_resource:
                    type: object
                    properties:
                      enabled:
                        type: boolean
                    description: å¼•ç”¨å’Œå½’å±è®¾ç½®
                  annotation_reply:
                    type: object
                    properties:
                      enabled:
                        type: boolean
                    description: æ ‡è®°å›å¤è®¾ç½®
                  user_input_form:
                    type: array
                    items:
                      type: object
                    description: ç”¨æˆ·è¾“å…¥è¡¨å•é…ç½®
                  file_upload:
                    type: object
                    description: æ–‡ä»¶ä¸Šä¼ é…ç½®
                  system_parameters:
                    type: object
                    properties:
                      file_size_limit:
                        type: integer
                        description: æ–‡æ¡£ä¸Šä¼ å¤§å°é™åˆ¶ (MB)
                      image_file_size_limit:
                        type: integer
                        description: å›¾ç‰‡æ–‡ä»¶ä¸Šä¼ å¤§å°é™åˆ¶ï¼ˆMBï¼‰
                      audio_file_size_limit:
                        type: integer
                        description: éŸ³é¢‘æ–‡ä»¶ä¸Šä¼ å¤§å°é™åˆ¶ (MB)
                      video_file_size_limit:
                        type: integer
                        description: è§†é¢‘æ–‡ä»¶ä¸Šä¼ å¤§å°é™åˆ¶ (MB)
                    description: ç³»ç»Ÿå‚æ•°

  /meta:
    get:
      operationId: getAppMetaInfoByAppChat
      summary: è·å–åº”ç”¨Metaä¿¡æ¯
      description: ç”¨äºè·å–å·¥å…·icon
      responses:
        "200":
          description: æˆåŠŸå“åº”
          content:
            application/json:
              schema:
                type: object
                properties:
                  tool_icons:
                    type: object
                    description: å·¥å…·å›¾æ ‡
                    additionalProperties:
                      oneOf:
                        - type: object
                          properties:
                            background:
                              type: string
                              description: hex æ ¼å¼çš„èƒŒæ™¯è‰²
                            content:
                              type: string
                              description: emoji
                        - type: string
                          description: å›¾æ ‡ URL

  /site:
    get:
      operationId: getAppSiteSettingsByAppChat
      summary: è·å–åº”ç”¨ WebApp è®¾ç½®
      description: ç”¨äºè·å–åº”ç”¨çš„ WebApp è®¾ç½®
      responses:
        "200":
          description: æˆåŠŸå“åº”
          content:
            application/json:
              schema:
                type: object
                properties:
                  title:
                    type: string
                    description: WebApp åç§°
                  chat_color_theme:
                    type: string
                    description: èŠå¤©é¢œè‰²ä¸»é¢˜ï¼Œhex æ ¼å¼
                  chat_color_theme_inverted:
                    type: boolean
                    description: èŠå¤©é¢œè‰²ä¸»é¢˜æ˜¯å¦åè½¬
                  icon_type:
                    type: string
                    description: å›¾æ ‡ç±»å‹ï¼Œemoji-è¡¨æƒ…ï¼Œimage-å›¾ç‰‡
                  icon:
                    type: string
                    description: å›¾æ ‡ï¼Œå¦‚æœæ˜¯ emoji ç±»å‹ï¼Œåˆ™æ˜¯ emoji è¡¨æƒ…ç¬¦å·ï¼Œå¦‚æœæ˜¯ image ç±»å‹ï¼Œåˆ™æ˜¯å›¾ç‰‡ URL
                  icon_background:
                    type: string
                    description: hex æ ¼å¼çš„èƒŒæ™¯è‰²
                  icon_url:
                    type: string
                    description: å›¾æ ‡ URL
                  description:
                    type: string
                    description: æè¿°
                  copyright:
                    type: string
                    description: ç‰ˆæƒä¿¡æ¯
                  privacy_policy:
                    type: string
                    description: éšç§æ”¿ç­–é“¾æ¥
                  custom_disclaimer:
                    type: string
                    description: è‡ªå®šä¹‰å…è´£å£°æ˜
                  default_language:
                    type: string
                    description: é»˜è®¤è¯­è¨€
                  show_workflow_steps:
                    type: boolean
                    description: æ˜¯å¦æ˜¾ç¤ºå·¥ä½œæµè¯¦æƒ…
                  use_icon_as_answer_icon:
                    type: boolean
                    description: æ˜¯å¦ä½¿ç”¨ WebApp å›¾æ ‡æ›¿æ¢èŠå¤©ä¸­çš„ ğŸ¤–

  /apps/annotations:
    get:
      operationId: getAnnotationsListByAppChat
      summary: è·å–æ ‡æ³¨åˆ—è¡¨
      description: è·å–åº”ç”¨çš„æ ‡æ³¨åˆ—è¡¨
      parameters:
        - name: page
          in: query
          description: é¡µç 
          required: false
          schema:
            type: integer
            default: 1
        - name: limit
          in: query
          description: æ¯é¡µæ•°é‡
          required: false
          schema:
            type: integer
            default: 20
      responses:
        "200":
          description: æˆåŠŸè·å–æ ‡æ³¨åˆ—è¡¨
          content:
            application/json:
              schema:
                type: object
                properties:
                  data:
                    type: array
                    items:
                      type: object
                      properties:
                        id:
                          type: string
                          description: æ ‡æ³¨ID
                        question:
                          type: string
                          description: é—®é¢˜
                        answer:
                          type: string
                          description: ç­”æ¡ˆ
                        hit_count:
                          type: integer
                          description: å‘½ä¸­æ¬¡æ•°
                        created_at:
                          type: integer
                          description: åˆ›å»ºæ—¶é—´æˆ³
                  has_more:
                    type: boolean
                    description: æ˜¯å¦æœ‰æ›´å¤šæ•°æ®
                  limit:
                    type: integer
                    description: æ¯é¡µæ•°é‡
                  total:
                    type: integer
                    description: æ€»è®°å½•æ•°
                  page:
                    type: integer
                    description: å½“å‰é¡µç 

    post:
      operationId: createAnnotationByAppChat
      summary: åˆ›å»ºæ ‡æ³¨
      description: åˆ›å»ºæ–°çš„æ ‡æ³¨
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - question
                - answer
              properties:
                question:
                  type: string
                  description: é—®é¢˜
                answer:
                  type: string
                  description: ç­”æ¡ˆ
      responses:
        "200":
          description: æˆåŠŸåˆ›å»ºæ ‡æ³¨
          content:
            application/json:
              schema:
                type: object
                properties:
                  id:
                    type: string
                    description: æ ‡æ³¨ID
                  question:
                    type: string
                    description: é—®é¢˜
                  answer:
                    type: string
                    description: ç­”æ¡ˆ
                  hit_count:
                    type: integer
                    description: å‘½ä¸­æ¬¡æ•°
                  created_at:
                    type: integer
                    description: åˆ›å»ºæ—¶é—´æˆ³

  /apps/annotations/{annotation_id}:
    put:
      operationId: updateAnnotationByAppChat
      summary: æ›´æ–°æ ‡æ³¨
      description: æ›´æ–°æŒ‡å®šçš„æ ‡æ³¨
      parameters:
        - name: annotation_id
          in: path
          description: æ ‡æ³¨ID
          required: true
          schema:
            type: string
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - question
                - answer
              properties:
                question:
                  type: string
                  description: é—®é¢˜
                answer:
                  type: string
                  description: ç­”æ¡ˆ
      responses:
        "200":
          description: æˆåŠŸæ›´æ–°æ ‡æ³¨
          content:
            application/json:
              schema:
                type: object
                properties:
                  id:
                    type: string
                    description: æ ‡æ³¨ID
                  question:
                    type: string
                    description: é—®é¢˜
                  answer:
                    type: string
                    description: ç­”æ¡ˆ
                  hit_count:
                    type: integer
                    description: å‘½ä¸­æ¬¡æ•°
                  created_at:
                    type: integer
                    description: åˆ›å»ºæ—¶é—´æˆ³

    delete:
      operationId: deleteAnnotationByAppChat
      summary: åˆ é™¤æ ‡æ³¨
      description: åˆ é™¤æŒ‡å®šçš„æ ‡æ³¨
      parameters:
        - name: annotation_id
          in: path
          description: æ ‡æ³¨ID
          required: true
          schema:
            type: string
      responses:
        "200":
          description: æˆåŠŸåˆ é™¤æ ‡æ³¨
          content:
            application/json:
              schema:
                type: object
                properties:
                  result:
                    type: string
                    enum: [success]

  /apps/annotation-reply/{action}:
    post:
      operationId: configureAnnotationReplyByAppChat
      summary: æ ‡æ³¨å›å¤åˆå§‹è®¾ç½®
      description: å¯ç”¨æˆ–ç¦ç”¨æ ‡æ³¨å›å¤åŠŸèƒ½
      parameters:
        - name: action
          in: path
          description: åŠ¨ä½œï¼Œåªèƒ½æ˜¯ 'enable' æˆ– 'disable'
          required: true
          schema:
            type: string
            enum: [enable, disable]
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                embedding_provider_name:
                  type: string
                  description: æŒ‡å®šçš„åµŒå…¥æ¨¡å‹æä¾›å•†, å¿…é¡»å…ˆåœ¨ç³»ç»Ÿå†…è®¾å®šå¥½æ¥å…¥çš„æ¨¡å‹ï¼Œå¯¹åº”çš„æ˜¯providerå­—æ®µ
                embedding_model_name:
                  type: string
                  description: æŒ‡å®šçš„åµŒå…¥æ¨¡å‹ï¼Œå¯¹åº”çš„æ˜¯modelå­—æ®µ
                score_threshold:
                  type: number
                  description: ç›¸ä¼¼åº¦é˜ˆå€¼ï¼Œå½“ç›¸ä¼¼åº¦å¤§äºè¯¥é˜ˆå€¼æ—¶ï¼Œç³»ç»Ÿä¼šè‡ªåŠ¨å›å¤ï¼Œå¦åˆ™ä¸å›å¤
      responses:
        "200":
          description: æˆåŠŸå¯ç”¨æˆ–ç¦ç”¨æ ‡æ³¨å›å¤
          content:
            application/json:
              schema:
                type: object
                properties:
                  job_id:
                    type: string
                    description: ä»»åŠ¡ID
                  job_status:
                    type: string
                    description: ä»»åŠ¡çŠ¶æ€

  /apps/annotation-reply/{action}/status/{job_id}:
    get:
      operationId: getAnnotationReplyStatusByAppChat
      summary: æŸ¥è¯¢æ ‡æ³¨å›å¤åˆå§‹è®¾ç½®ä»»åŠ¡çŠ¶æ€
      description: æŸ¥è¯¢æ ‡æ³¨å›å¤åˆå§‹è®¾ç½®ä»»åŠ¡çš„æ‰§è¡ŒçŠ¶æ€
      parameters:
        - name: action
          in: path
          description: åŠ¨ä½œï¼Œåªèƒ½æ˜¯ 'enable' æˆ– 'disable'ï¼Œå¹¶ä¸”å¿…é¡»å’Œæ ‡æ³¨å›å¤åˆå§‹è®¾ç½®æ¥å£çš„åŠ¨ä½œä¸€è‡´
          required: true
          schema:
            type: string
            enum: [enable, disable]
        - name: job_id
          in: path
          description: ä»»åŠ¡IDï¼Œä»æ ‡æ³¨å›å¤åˆå§‹è®¾ç½®æ¥å£è¿”å›çš„job_id
          required: true
          schema:
            type: string
      responses:
        "200":
          description: æˆåŠŸè·å–ä»»åŠ¡çŠ¶æ€
          content:
            application/json:
              schema:
                type: object
                properties:
                  job_id:
                    type: string
                    description: ä»»åŠ¡ID
                  job_status:
                    type: string
                    description: ä»»åŠ¡çŠ¶æ€
                  error_msg:
                    type: string
                    description: é”™è¯¯ä¿¡æ¯
